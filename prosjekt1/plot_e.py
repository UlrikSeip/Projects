# -*- coding: utf-8 -*-
"""
Created on Mon Sep 10 17:10:35 2018

@author: Bendik
"""

import seaborn
from numpy import zeros, exp, linspace, ones
from matplotlib.pyplot import plot, show, title, xlabel, ylabel, savefig, xscale, yscale

def rref(n):
    a = ones(n-1)
    a *= -1
    b = ones(n)
    b *= 2
    c = ones(n-1)
    c *= -1
    
    B = zeros(n)
    #v = zeros(n)
    b_ = zeros(n)
    k = zeros(n)
    B_ = zeros(n)
    x = linspace(0, 1, n)
    
    h = 1/(n+1)
    
    def f(x):
        return (100*exp(-10*x))
    
    u = 1 - (1 - exp(-10))*x - exp(-10*x)
    
    for i in range(n):
        B[i] = h**2*f(x[i])
    
        
    b_[0] = b[0]
    B_[0] = B[0]
    for i in range(1, n):
        temp = a[i-1]/b_[i-1]
        b_[i] = b[i] - temp*c[i-1]
        B_[i] = B[i] - temp*B_[i-1]
    
    k[n-1] = B_[n-1]
    i = n-2
    while i >= 0:
        k[i] = B_[i] - c[i]*k[i+1]/b_[i]
        i-=1
    return x, k, b_, u

def plot_rref(n):
    x, k, b_, u = rref(n) 
    
    plot(x, k)
    #leg.append("n: " + str(n))
    return x, u

plot_rref(100)
x = linspace(0, 1, 100)
k = [0.0902754, 0.180551, 0.257535, 0.324823, 0.383931, 0.435893, 0.481528, 0.521523, 0.556475, 0.586903, 0.61327, 0.635985, 0.655414, 0.671885, 0.685692, 0.697098, 0.706341, 0.713634, 0.719168, 0.723117, 0.725636, 0.726866, 0.726933, 0.725951, 0.724022, 0.721241, 0.71769, 0.713445, 0.708573, 0.703137, 0.697192, 0.690788, 0.683969, 0.676778, 0.66925, 0.661418, 0.653313, 0.644961, 0.636388, 0.627614, 0.61866, 0.609544, 0.600281, 0.590887, 0.581375, 0.571755, 0.56204, 0.552239, 0.54236, 0.532412, 0.5224, 0.512333, 0.502215, 0.492052, 0.481848, 0.471608, 0.461335, 0.451033, 0.440704, 0.430353, 0.41998, 0.409589, 0.399182, 0.388759, 0.378324, 0.367877, 0.357419, 0.346952, 0.336478, 0.325996, 0.315508, 0.305014, 0.294516, 0.284013, 0.273507, 0.262998, 0.252486, 0.241972, 0.231455, 0.220938, 0.210419, 0.199898, 0.189377, 0.178856, 0.168334, 0.157811, 0.147289, 0.136766, 0.126243, 0.115721, 0.105198, 0.0946764, 0.0841548, 0.0736336, 0.0631128, 0.0525925, 0.0420728, 0.0315536, 0.021035, 0.010517]

plot(x, k)
xlabel("x"); ylabel("f(x)")

title("Plot of the aprox. and exact solutions")
savefig("test_e.pdf")
show()

